"""데이터 모델 정의."""

from dataclasses import dataclass, field
from typing import Optional


@dataclass
class VulnItem:
    """취약점 점검 항목 데이터 모델."""

    항목코드: str
    항목명: str = ""
    자산분류: str = ""
    점검대상: str = ""
    중요도: str = ""
    점검내용: str = ""
    점검목적: str = ""
    보안위협: str = ""
    판단기준_양호: str = ""
    판단기준_취약: str = ""
    점검방법: str = ""
    조치방법: str = ""
    조치시영향: str = ""
    참조섹션: str = ""
    근거문구: str = ""

    def to_dict(self) -> dict[str, str]:
        """CSV 출력용 딕셔너리로 변환."""
        return {
            "항목코드": self.항목코드,
            "항목명": self.항목명,
            "자산분류": self.자산분류,
            "점검대상(OS/제품)": self.점검대상,
            "중요도": self.중요도,
            "점검내용": self.점검내용,
            "점검목적": self.점검목적,
            "보안위협": self.보안위협,
            "판단기준(양호)": self.판단기준_양호,
            "판단기준(취약)": self.판단기준_취약,
            "점검방법(절차)": self.점검방법,
            "조치방법": self.조치방법,
            "조치시영향": self.조치시영향,
            "참조섹션(페이지/챕터)": self.참조섹션,
            "근거문구(짧은발췌)": self.근거문구,
        }


# CSV 컬럼 순서 고정
CSV_COLUMNS: list[str] = [
    "항목코드",
    "항목명",
    "자산분류",
    "점검대상(OS/제품)",
    "중요도",
    "점검내용",
    "점검목적",
    "보안위협",
    "판단기준(양호)",
    "판단기준(취약)",
    "점검방법(절차)",
    "조치방법",
    "조치시영향",
    "참조섹션(페이지/챕터)",
    "근거문구(짧은발췌)",
]
